const m=new Set(["management","cookies","webRequest","declarativeNetRequest","debugger","downloads","history","nativeMessaging","proxy","privacy","tabCapture"]),u=["mail.google.com","drive.google.com","docs.google.com","web.whatsapp.com","outlook.office.com"];function h(s,n){let e=0;const o=[],a=[],c=s.permissions.filter(t=>m.has(t));c.length>0&&(e+=Math.min(c.length*15,50),o.push(`Szenzitív API jogosultságokat használ: ${c.join(", ")}.`));let g=!1;const l=[];for(const t of s.hostPermissions){(t.includes("<all_urls>")||t.includes("*://*/*"))&&(g=!0);for(const r of u)t.includes(r)&&l.push(r)}if(g&&(e+=40,o.push("Minden weboldalhoz hozzáférést kér (<all_urls> vagy globális minta).")),l.length>0&&(e+=l.length*10,o.push(`Szenzitív weboldalakhoz (pl. levelezés, dokumentumok) kér hozzáférést: ${l.join(", ")}.`)),s.permissions.includes("scripting")&&s.hostPermissions.length>0&&(e+=15,o.push("Képes scripteket futtatni a meglátogatott weboldalakon (Content injection rizikó).")),n&&n.version!==s.version){const t=s.permissions.filter(i=>!n.permissions.includes(i)&&m.has(i)),r=s.hostPermissions.filter(i=>!n.hostPermissions.includes(i)&&(i.includes("<all_urls>")||u.some(d=>i.includes(d))));(t.length>0||r.length>0)&&(e+=20,o.push("A legutóbbi frissítés során hirtelen új, szenzitív jogosultságokat kért."))}return e=Math.min(e,100),e>=70?a.push("Erősen javasolt a bővítmény kikapcsolása vagy eltávolítása, ha nem feltétlenül szükséges."):e>=40&&a.push("Érdemes átgondolni, hogy valóban szükség van-e a bővítmény által kért jogokra."),{score:e,reasons:o,recommendedActions:a}}export{h as c};
