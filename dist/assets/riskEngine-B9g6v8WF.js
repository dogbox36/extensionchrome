const d=new Set(["management","cookies","webRequest","declarativeNetRequest","debugger","downloads","history","nativeMessaging","proxy","privacy","tabCapture"]),h=["mail.google.com","drive.google.com","docs.google.com","web.whatsapp.com","outlook.office.com"];function k(s,n,l){let e=0;const i=[],c=[];if(l?.whitelistedExtensionIds.includes(s.id))return{score:0,reasons:["A bővítmény a felhasználó által megbízhatóként (fehérlistás) van megjelölve."],recommendedActions:[]};const g=s.permissions.filter(t=>d.has(t));g.length>0&&(e+=Math.min(g.length*15,50),i.push(`Szenzitív API jogosultságokat használ: ${g.join(", ")}.`));let m=!1;const r=[];for(const t of s.hostPermissions){(t.includes("<all_urls>")||t.includes("*://*/*"))&&(m=!0);for(const a of h)t.includes(a)&&r.push(a)}if(m&&(e+=40,i.push("Minden weboldalhoz hozzáférést kér (<all_urls> vagy globális minta).")),r.length>0&&(e+=r.length*10,i.push(`Szenzitív weboldalakhoz (pl. levelezés, dokumentumok) kér hozzáférést: ${r.join(", ")}.`)),s.permissions.includes("scripting")&&s.hostPermissions.length>0&&(e+=15,i.push("Képes scripteket futtatni a meglátogatott weboldalakon (Content injection rizikó).")),n&&n.version!==s.version){const t=s.permissions.filter(o=>!n.permissions.includes(o)&&d.has(o)),a=s.hostPermissions.filter(o=>!n.hostPermissions.includes(o)&&(o.includes("<all_urls>")||h.some(u=>o.includes(u))));(t.length>0||a.length>0)&&(e+=20,i.push("A legutóbbi frissítés során hirtelen új, szenzitív jogosultságokat kért."))}return l&&(l.riskSensitivity==="low"?e=Math.floor(e*.7):l.riskSensitivity==="high"&&(e=Math.floor(e*1.3))),e=Math.min(e,100),e>=70?c.push("Erősen javasolt a bővítmény kikapcsolása vagy eltávolítása, ha nem feltétlenül szükséges."):e>=40&&c.push("Érdemes átgondolni, hogy valóban szükség van-e a bővítmény által kért jogokra."),{score:e,reasons:i,recommendedActions:c}}export{k as c};
