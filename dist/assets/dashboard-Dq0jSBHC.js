import{j as e,c as M}from"./index-C42e8LgL.js";import{r as c}from"./index-CfHSjnos.js";import{s as A}from"./storage-BmJBOsSV.js";import{c as v}from"./riskEngine-B9g6v8WF.js";const S=({score:r})=>{let t="bg-gray-100 text-gray-800 border-gray-200",a="Ismeretlen";return r>=70?(t="bg-red-50 text-red-700 border-red-200",a="Magas Kockázat"):r>=40?(t="bg-yellow-50 text-yellow-700 border-yellow-200",a="Közepes Kockázat"):r>=0&&(t="bg-green-50 text-green-700 border-green-200",a="Alacsony Kockázat"),e.jsxs("div",{className:`inline-flex items-center px-2.5 py-0.5 rounded-md text-sm font-medium border ${t}`,children:[e.jsxs("span",{className:"mr-1.5 font-bold",children:[r,"/100"]}),e.jsx("span",{children:a})]})};const _=(...r)=>r.filter((t,a,l)=>!!t&&t.trim()!==""&&l.indexOf(t)===a).join(" ").trim();const E=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();const $=r=>r.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,a,l)=>l?l.toUpperCase():a.toLowerCase());const N=r=>{const t=$(r);return t.charAt(0).toUpperCase()+t.slice(1)};var K={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const L=r=>{for(const t in r)if(t.startsWith("aria-")||t==="role"||t==="title")return!0;return!1};const B=c.forwardRef(({color:r="currentColor",size:t=24,strokeWidth:a=2,absoluteStrokeWidth:l,className:n="",children:i,iconNode:h,...y},x)=>c.createElement("svg",{ref:x,...K,width:t,height:t,stroke:r,strokeWidth:l?Number(a)*24/Number(t):a,className:_("lucide",n),...!i&&!L(y)&&{"aria-hidden":"true"},...y},[...h.map(([u,p])=>c.createElement(u,p)),...Array.isArray(i)?i:[i]]));const m=(r,t)=>{const a=c.forwardRef(({className:l,...n},i)=>c.createElement(B,{ref:i,iconNode:t,className:_(`lucide-${E(N(r))}`,`lucide-${r}`,l),...n}));return a.displayName=N(r),a};const H=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],R=m("chevron-down",H);const I=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],D=m("chevron-up",I);const q=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],V=m("circle-alert",q);const O=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],T=m("external-link",O);const U=[["path",{d:"M18.36 6.64A9 9 0 0 1 20.77 15",key:"dxknvb"}],["path",{d:"M6.16 6.16a9 9 0 1 0 12.68 12.68",key:"1x7qb5"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],W=m("power-off",U);const Z=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],F=m("search",Z);const J=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],G=m("settings",J);const Q=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],C=m("shield-alert",Q);const X=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],z=m("shield-check",X);const Y=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],ee=m("trash-2",Y),re=({extension:r,config:t})=>{const[a,l]=c.useState(!1),n=v(r,void 0,t||void 0),i=new Set(r.previousPermissions||r.permissions),h=new Set(r.permissions),y=r.permissions.filter(s=>!i.has(s)),x=(r.previousPermissions||[]).filter(s=>!h.has(s)),u=r.permissions.filter(s=>i.has(s)),p=new Set(r.previousHostPermissions||r.hostPermissions),o=new Set(r.hostPermissions),b=r.hostPermissions.filter(s=>!p.has(s)),d=(r.previousHostPermissions||[]).filter(s=>!o.has(s)),g=r.hostPermissions.filter(s=>p.has(s)),f=()=>{chrome.tabs.create({url:`chrome://extensions/?id=${r.id}`})},j=()=>{chrome.management.setEnabled(r.id,!1,()=>{window.location.reload()})},w=()=>{chrome.management.uninstall(r.id,{showConfirmDialog:!0},()=>{window.location.reload()})};return e.jsxs("div",{className:`bg-white dark:bg-gray-800 rounded-lg shadow-sm border ${n.score>=70?"border-red-300 dark:border-red-800":"border-gray-200 dark:border-gray-700"} overflow-hidden transition-all`,children:[e.jsxs("div",{className:"p-4 flex items-center justify-between cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",onClick:()=>l(!a),children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-gray-100 dark:bg-gray-700 rounded flex items-center justify-center text-gray-400 dark:text-gray-500",children:e.jsx(C,{size:20,className:n.score>=70?"text-red-500":n.score>=40?"text-yellow-500":"text-green-500"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white flex items-center",children:[r.name,!r.enabled&&e.jsx("span",{className:"ml-2 text-xs bg-gray-200 dark:bg-gray-600 text-gray-600 dark:text-gray-300 px-2 py-0.5 rounded",children:"Kikapcsolva"})]}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Verzió: ",r.version," | ID: ",r.id]})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(S,{score:n.score}),a?e.jsx(D,{size:20,className:"text-gray-400"}):e.jsx(R,{size:20,className:"text-gray-400"})]})]}),a&&e.jsxs("div",{className:"border-t border-gray-100 dark:border-gray-700 bg-gray-50 dark:bg-gray-900/50 p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 dark:text-gray-200 mb-2 uppercase tracking-wider",children:"Kockázatelemzés"}),n.reasons.length>0?e.jsx("ul",{className:"space-y-2",children:n.reasons.map((s,k)=>e.jsxs("li",{className:"flex items-start text-sm text-gray-700 dark:text-gray-300",children:[e.jsx(V,{size:16,className:"text-yellow-500 mr-2 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:s})]},k))}):e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 flex items-center",children:[e.jsx(C,{size:16,className:"text-green-500 mr-2"}),"Nem találtunk gyanús jogosultságot."]}),n.recommendedActions.length>0&&e.jsxs("div",{className:"mt-4 p-3 bg-blue-50 dark:bg-blue-900/30 text-blue-800 dark:text-blue-200 rounded-md text-sm border border-blue-100 dark:border-blue-800/50",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Javaslat:"}),e.jsx("ul",{className:"list-disc pl-5 space-y-1",children:n.recommendedActions.map((s,k)=>e.jsx("li",{children:s},k))})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 dark:text-gray-200 mb-2 uppercase tracking-wider",children:"Használt API engedélyek"}),r.permissions.length>0||x.length>0?e.jsxs("div",{className:"flex flex-wrap gap-1 mb-4",children:[y.map(s=>e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 dark:bg-green-900/40 text-green-800 dark:text-green-300 border border-green-200 dark:border-green-800 font-mono",children:["+",s]},s)),x.map(s=>e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-red-100 dark:bg-red-900/40 text-red-800 dark:text-red-300 border border-red-200 dark:border-red-800 font-mono line-through",children:["-",s]},s)),u.map(s=>e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 font-mono",children:s},s))]}):e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:"Nincsenek extra API engedélyek."}),e.jsx("h4",{className:"text-sm font-semibold text-gray-900 dark:text-gray-200 mb-2 uppercase tracking-wider",children:"Weboldal hozzáférések"}),r.hostPermissions.length>0||d.length>0?e.jsxs("div",{className:"flex flex-wrap gap-1",children:[b.map(s=>e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 dark:bg-green-900/40 text-green-800 dark:text-green-300 border border-green-200 dark:border-green-800 font-mono",children:["+",s]},s)),d.map(s=>e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-red-100 dark:bg-red-900/40 text-red-800 dark:text-red-300 border border-red-200 dark:border-red-800 font-mono line-through",children:["-",s]},s)),g.map(s=>e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-indigo-100 dark:bg-indigo-900/40 text-indigo-800 dark:text-indigo-200 font-mono",children:s},s))]}):e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Nincs specifikus weboldal hozzáférés."})]})]}),e.jsxs("div",{className:"mt-6 flex flex-wrap gap-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("button",{onClick:f,className:"inline-flex items-center px-3 py-1.5 border border-gray-300 dark:border-gray-600 shadow-sm text-sm font-medium rounded-md text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx(T,{size:16,className:"mr-2"}),"Bővítménykezelő"]}),r.enabled&&e.jsxs("button",{onClick:j,className:"inline-flex items-center px-3 py-1.5 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-yellow-600 hover:bg-yellow-700",children:[e.jsx(W,{size:16,className:"mr-2"}),"Kikapcsolás"]}),e.jsxs("button",{onClick:w,className:"inline-flex items-center px-3 py-1.5 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700",children:[e.jsx(ee,{size:16,className:"mr-2"}),"Eltávolítás"]})]})]})]})},se=()=>{const[r,t]=c.useState([]),[a,l]=c.useState(null),[n,i]=c.useState(!0),[h,y]=c.useState(""),[x,u]=c.useState("all");c.useEffect(()=>{const o=async()=>{const d=await A.getConfig();l(d),chrome.storage.local.get("extensionsBaseline",g=>{const f=g.extensionsBaseline;if(!f){t([]),i(!1);return}const j=Object.values(f);j.sort((w,s)=>{const k=v(w,void 0,d).score;return v(s,void 0,d).score-k}),t(j),i(!1)})};o();const b=d=>{d.extensionsBaseline&&o()};return chrome.storage.onChanged.addListener(b),()=>{chrome.storage.onChanged.removeListener(b)}},[]);const p=r.filter(o=>{const b=o.name.toLowerCase().includes(h.toLowerCase())||o.id.toLowerCase().includes(h.toLowerCase()),d=v(o,void 0,a||void 0).score;let g=!0;return x==="high"?g=d>=70:x==="medium"?g=d>=40&&d<70:x==="low"&&(g=d<40),b&&g});return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex flex-col font-sans",children:[e.jsx("header",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 sticky top-0 z-10",children:e.jsxs("div",{className:"max-w-5xl mx-auto py-4 px-4 sm:px-6 lg:px-8 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center text-blue-600",children:[e.jsx(z,{size:32,className:"mr-3 text-blue-500"}),e.jsx("h1",{className:"text-2xl font-bold tracking-tight text-gray-900 dark:text-white",children:"Extension Trust Monitor"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 font-medium",children:[e.jsxs("span",{children:["Összesen: ",r.length," db"]}),e.jsxs("button",{onClick:()=>chrome.runtime.openOptionsPage(),className:"flex items-center gap-1 px-3 py-1.5 bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 rounded-md transition-colors",children:[e.jsx(G,{size:16}),e.jsx("span",{children:"Beállítások"})]})]})]})}),e.jsxs("main",{className:"flex-1 w-full max-w-5xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-8 bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(F,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md leading-5 bg-white dark:bg-gray-700 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm transition duration-150 ease-in-out",placeholder:"Keresés név vagy ID alapján...",value:h,onChange:o=>y(o.target.value)})]}),e.jsx("div",{className:"sm:w-64 shrink-0",children:e.jsxs("select",{"aria-label":"Kockázati szűrő",className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md border bg-white dark:bg-gray-700 dark:text-white",value:x,onChange:o=>u(o.target.value),children:[e.jsx("option",{value:"all",children:"Minden Kockázati Színt"}),e.jsx("option",{value:"high",children:"Magas Kockázat (70+)"}),e.jsx("option",{value:"medium",children:"Közepes Kockázat (40-69)"}),e.jsx("option",{value:"low",children:"Alacsony Kockázat (0-39)"})]})})]}),n?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):p.length>0?e.jsx("div",{className:"space-y-4",children:p.map(o=>e.jsx(re,{extension:o,config:a},o.id))}):e.jsxs("div",{className:"text-center bg-white dark:bg-gray-800 p-12 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm",children:[e.jsx(z,{size:48,className:"mx-auto text-gray-300 dark:text-gray-600 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Nincs találat"}),e.jsx("p",{className:"mt-1 text-gray-500 dark:text-gray-400",children:"Próbálj meg más keresési feltételt megadni."})]})]})]})},P=document.getElementById("root");P&&M.createRoot(P).render(e.jsx(se,{}));
