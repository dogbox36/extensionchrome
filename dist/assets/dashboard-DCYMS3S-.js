import{r as C,j as e,c as M}from"./index-Bdt4ARUj.js";import{c as u}from"./riskEngine-D4_ttAbt.js";var o=C();const _=({score:s})=>{let t="bg-gray-100 text-gray-800 border-gray-200",a="Ismeretlen";return s>=70?(t="bg-red-50 text-red-700 border-red-200",a="Magas Kockázat"):s>=40?(t="bg-yellow-50 text-yellow-700 border-yellow-200",a="Közepes Kockázat"):s>=0&&(t="bg-green-50 text-green-700 border-green-200",a="Alacsony Kockázat"),e.jsxs("div",{className:`inline-flex items-center px-2.5 py-0.5 rounded-md text-sm font-medium border ${t}`,children:[e.jsxs("span",{className:"mr-1.5 font-bold",children:[s,"/100"]}),e.jsx("span",{children:a})]})};const N=(...s)=>s.filter((t,a,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===a).join(" ").trim();const A=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();const E=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,a,r)=>r?r.toUpperCase():a.toLowerCase());const b=s=>{const t=E(s);return t.charAt(0).toUpperCase()+t.slice(1)};var K={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const $=s=>{for(const t in s)if(t.startsWith("aria-")||t==="role"||t==="title")return!0;return!1};const L=o.forwardRef(({color:s="currentColor",size:t=24,strokeWidth:a=2,absoluteStrokeWidth:r,className:c="",children:i,iconNode:m,...n},x)=>o.createElement("svg",{ref:x,...K,width:t,height:t,stroke:s,strokeWidth:r?Number(a)*24/Number(t):a,className:N("lucide",c),...!i&&!$(n)&&{"aria-hidden":"true"},...n},[...m.map(([l,p])=>o.createElement(l,p)),...Array.isArray(i)?i:[i]]));const d=(s,t)=>{const a=o.forwardRef(({className:r,...c},i)=>o.createElement(L,{ref:i,iconNode:t,className:N(`lucide-${A(b(s))}`,`lucide-${s}`,r),...c}));return a.displayName=b(s),a};const S=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],B=d("chevron-down",S);const R=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],I=d("chevron-up",R);const P=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],q=d("circle-alert",P);const D=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],V=d("external-link",D);const O=[["path",{d:"M18.36 6.64A9 9 0 0 1 20.77 15",key:"dxknvb"}],["path",{d:"M6.16 6.16a9 9 0 1 0 12.68 12.68",key:"1x7qb5"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],T=d("power-off",O);const U=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],H=d("search",U);const W=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],f=d("shield-alert",W);const Z=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],j=d("shield-check",Z);const F=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],J=d("trash-2",F),G=({extension:s})=>{const[t,a]=o.useState(!1),r=u(s),c=()=>{chrome.tabs.create({url:`chrome://extensions/?id=${s.id}`})},i=()=>{chrome.management.setEnabled(s.id,!1,()=>{window.location.reload()})},m=()=>{chrome.management.uninstall(s.id,{showConfirmDialog:!0},()=>{window.location.reload()})};return e.jsxs("div",{className:`bg-white rounded-lg shadow-sm border ${r.score>=70?"border-red-300":"border-gray-200"} overflow-hidden transition-all`,children:[e.jsxs("div",{className:"p-4 flex items-center justify-between cursor-pointer hover:bg-gray-50 transition-colors",onClick:()=>a(!t),children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-gray-100 rounded flex items-center justify-center text-gray-400",children:e.jsx(f,{size:20,className:r.score>=70?"text-red-500":r.score>=40?"text-yellow-500":"text-green-500"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[s.name,!s.enabled&&e.jsx("span",{className:"ml-2 text-xs bg-gray-200 text-gray-600 px-2 py-0.5 rounded",children:"Kikapcsolva"})]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Verzió: ",s.version," | ID: ",s.id]})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(_,{score:r.score}),t?e.jsx(I,{size:20,className:"text-gray-400"}):e.jsx(B,{size:20,className:"text-gray-400"})]})]}),t&&e.jsxs("div",{className:"border-t border-gray-100 bg-gray-50 p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-2 uppercase tracking-wider",children:"Kockázatelemzés"}),r.reasons.length>0?e.jsx("ul",{className:"space-y-2",children:r.reasons.map((n,x)=>e.jsxs("li",{className:"flex items-start text-sm text-gray-700",children:[e.jsx(q,{size:16,className:"text-yellow-500 mr-2 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:n})]},x))}):e.jsxs("p",{className:"text-sm text-gray-500 flex items-center",children:[e.jsx(f,{size:16,className:"text-green-500 mr-2"}),"Nem találtunk gyanús jogosultságot."]}),r.recommendedActions.length>0&&e.jsxs("div",{className:"mt-4 p-3 bg-blue-50 text-blue-800 rounded-md text-sm border border-blue-100",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Javaslat:"}),e.jsx("ul",{className:"list-disc pl-5 space-y-1",children:r.recommendedActions.map((n,x)=>e.jsx("li",{children:n},x))})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-2 uppercase tracking-wider",children:"Használt API engedélyek"}),s.permissions.length>0?e.jsx("div",{className:"flex flex-wrap gap-1 mb-4",children:s.permissions.map(n=>e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-200 text-gray-800 font-mono",children:n},n))}):e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Nincsenek extra API engedélyek."}),e.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-2 uppercase tracking-wider",children:"Weboldal hozzáférések"}),s.hostPermissions.length>0?e.jsx("div",{className:"flex flex-wrap gap-1",children:s.hostPermissions.map(n=>e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-indigo-100 text-indigo-800 font-mono",children:n},n))}):e.jsx("p",{className:"text-sm text-gray-500",children:"Nincs specifikus weboldal hozzáférés."})]})]}),e.jsxs("div",{className:"mt-6 flex flex-wrap gap-3 pt-4 border-t border-gray-200",children:[e.jsxs("button",{onClick:c,className:"inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(V,{size:16,className:"mr-2"}),"Bővítménykezelő"]}),s.enabled&&e.jsxs("button",{onClick:i,className:"inline-flex items-center px-3 py-1.5 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-yellow-600 hover:bg-yellow-700",children:[e.jsx(T,{size:16,className:"mr-2"}),"Kikapcsolás"]}),e.jsxs("button",{onClick:m,className:"inline-flex items-center px-3 py-1.5 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700",children:[e.jsx(J,{size:16,className:"mr-2"}),"Eltávolítás"]})]})]})]})},Q=()=>{const[s,t]=o.useState([]),[a,r]=o.useState(!0),[c,i]=o.useState(""),[m,n]=o.useState("all");o.useEffect(()=>{const l=async()=>{chrome.storage.local.get("extensionsBaseline",h=>{const g=h.extensionsBaseline;if(!g){t([]),r(!1);return}const y=Object.values(g);y.sort((w,v)=>{const z=u(w).score;return u(v).score-z}),t(y),r(!1)})};l();const p=h=>{h.extensionsBaseline&&l()};return chrome.storage.onChanged.addListener(p),()=>{chrome.storage.onChanged.removeListener(p)}},[]);const x=s.filter(l=>{const p=l.name.toLowerCase().includes(c.toLowerCase())||l.id.toLowerCase().includes(c.toLowerCase()),h=u(l).score;let g=!0;return m==="high"?g=h>=70:m==="medium"?g=h>=40&&h<70:m==="low"&&(g=h<40),p&&g});return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col font-sans",children:[e.jsx("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-10",children:e.jsxs("div",{className:"max-w-5xl mx-auto py-4 px-4 sm:px-6 lg:px-8 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center text-blue-600",children:[e.jsx(j,{size:32,className:"mr-3"}),e.jsx("h1",{className:"text-2xl font-bold tracking-tight text-gray-900",children:"Extension Trust Monitor"})]}),e.jsxs("div",{className:"text-sm text-gray-500 font-medium",children:["Összesen: ",s.length," db"]})]})}),e.jsxs("main",{className:"flex-1 w-full max-w-5xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-8 bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(H,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm transition duration-150 ease-in-out",placeholder:"Keresés név vagy ID alapján...",value:c,onChange:l=>i(l.target.value)})]}),e.jsx("div",{className:"sm:w-64 shrink-0",children:e.jsxs("select",{"aria-label":"Kockázati szűrő",className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md border bg-white",value:m,onChange:l=>n(l.target.value),children:[e.jsx("option",{value:"all",children:"Minden Kockázati Színt"}),e.jsx("option",{value:"high",children:"Magas Kockázat (70+)"}),e.jsx("option",{value:"medium",children:"Közepes Kockázat (40-69)"}),e.jsx("option",{value:"low",children:"Alacsony Kockázat (0-39)"})]})})]}),a?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):x.length>0?e.jsx("div",{className:"space-y-4",children:x.map(l=>e.jsx(G,{extension:l},l.id))}):e.jsxs("div",{className:"text-center bg-white p-12 rounded-lg border border-gray-200 shadow-sm",children:[e.jsx(j,{size:48,className:"mx-auto text-gray-300 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Nincs találat"}),e.jsx("p",{className:"mt-1 text-gray-500",children:"Próbálj meg más keresési feltételt megadni."})]})]})]})},k=document.getElementById("root");k&&M.createRoot(k).render(e.jsx(Q,{}));
