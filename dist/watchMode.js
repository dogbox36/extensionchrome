console.log("Trust Monitor Watch Mode betöltve.");let r=!1;const f=["malicious.example.com","tracker.xyz"];function s(){if(r)return;const t=document.querySelectorAll("iframe");for(let e=0;e<t.length;e++){const n=t[e],i=n.getBoundingClientRect(),a=i.width>=window.innerWidth*.9&&i.height>=window.innerHeight*.9&&i.top<=window.innerHeight*.1;let o=!1;try{o=new URL(n.src).hostname!==window.location.hostname}catch{}if(a&&o){alert(`⚠️ Trust Monitor Figyelmeztetés:

Egy másik bővítmény egy teljes képernyős réteget (iframe) helyezett az oldal fölé. Ez biztonsági kockázatot jelenthet (Adathalászat / Clickjacking)!`),r=!0;break}}}function l(){if(r)return;const t=document.querySelectorAll("script");for(let e=0;e<t.length;e++){const n=t[e].src;if(n){for(const i of f)if(n.includes(i)){console.error(`Trust Monitor: Gyanús script betöltés blokkolva/jelezve: ${n}`),r=!0;break}}}}function c(){if(r)return;const t=["CoinHive","CryptoNoter","JSECoin","CH"];for(const e of t)if(window[e]){console.error(`Trust Monitor: Kriptobányász (Cryptomining) script detektálva: ${e}`),alert(`⚠️ Trust Monitor Figyelmeztetés:

Kriptobányász tevékenység észlelve (${e}) a háttérben!`),r=!0;break}}function y(){let t=0,e=0;document.addEventListener("keydown",n=>{if(!r){if(!n.isTrusted)e+=10;else{const i=Date.now();i-t<20?e++:e=1,t=i}e>50&&(alert(`⚠️ Trust Monitor Figyelmeztetés:

Gyanús szintetikus billentyűzet-aktivitás (Keylogger/Form manipuláció)!`),r=!0,e=0)}},{capture:!0,passive:!0})}y();setTimeout(()=>{s(),l(),c()},2e3);setInterval(()=>{s(),l(),c()},5e3);
